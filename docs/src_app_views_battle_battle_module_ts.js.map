{"version":3,"file":"src_app_views_battle_battle_module_ts.js","mappings":"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","sources":["./src/app/views/battle/battle.component.ts","./src/app/views/battle/battle.component.html","./src/app/views/battle/battle.module.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { BattleService } from '../../core/services/battle.service';\r\nimport { Battle } from '@core/models/battle.model';\r\nimport { SoundService } from '../../core/services/sound.service';\r\nimport { PlayerService } from '@core/services/player.service';\r\nimport { PlayerStats } from '@core/models/player-stats.model';\r\nimport { Router } from '@angular/router';\r\n\r\n@Component({\r\n  selector: 'app-battle',\r\n  templateUrl: './battle.component.html',\r\n  styleUrls: ['./battle.component.scss']\r\n})\r\nexport class BattleComponent implements OnInit {\r\n  battle: Battle | null = null;\r\n  playerHp: number | null = null;\r\n  hpInput: number = 0;\r\n\r\n  constructor(\r\n    private battleService: BattleService,\r\n    private soundService: SoundService,\r\n    private playerService: PlayerService,\r\n    private router: Router\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    this.battleService.getCurrentBattle().subscribe(b => {\r\n      this.battle = b;\r\n      if (b) {\r\n        this.soundService.playBossMusic(b.bossId);\r\n        this.loadPlayerHp();\r\n      }\r\n    });\r\n  }\r\n\r\n  loadPlayerHp() {\r\n    this.playerService.getPlayer().subscribe(player => {\r\n      if (!player) return;\r\n      this.playerHp = player.hp;\r\n    });\r\n  }\r\n\r\n\r\n  adjustHp(isPercent: boolean) {\r\n    if (!this.playerHp || this.hpInput <= 0) return;\r\n\r\n    let amount = isPercent\r\n      ? Math.floor((this.hpInput / 100) * this.playerHp)\r\n      : this.hpInput;\r\n\r\n    //const confirmed = window.confirm(`Wirklich ${amount} HP abziehen?`);\r\n    //if (!confirmed) return;\r\n\r\n    this.playerService.getPlayer().subscribe(player => {\r\n      if (!player) return; // Absicherung\r\n\r\n      const newHp = player.hp - amount;\r\n      player.hp = newHp;\r\n      this.playerService.updatePlayer(player);\r\n      this.playerHp = player.hp;\r\n    });\r\n  }\r\n\r\n  finish(won: boolean) {\r\n    this.battleService.finishBattle(won).then(() => {\r\n      this.router.navigate(['/game']);\r\n    });\r\n  }\r\n}\r\n","<div class=\"battle-container\" *ngIf=\"battle\">\r\n  <h2 class=\"boss-name\">Kampf gegen: {{ battle.bossId }}</h2>\r\n  <p class=\"timestamp\">Beginn: {{ battle.startedAt | date: 'shortTime' }}</p>\r\n\r\n  <div class=\"advantages\" *ngIf=\"battle.advantagesUnlocked.length > 0\">\r\n    <h3>Deine Vorteile</h3>\r\n    <ul>\r\n      <li *ngFor=\"let adv of battle.advantagesUnlocked\">\r\n        <strong>{{ adv.name }}</strong><br />\r\n        <span>{{ adv.description }}</span>\r\n      </li>\r\n    </ul>\r\n  </div>\r\n<div class=\"hp-manipulation\" *ngIf=\"playerHp !== null\">\r\n  <h3>HP: {{ playerHp }} </h3>\r\n\r\n  <label>\r\n    <input type=\"number\" [(ngModel)]=\"hpInput\" placeholder=\"z. B. 10 oder 25\" />\r\n  </label>\r\n\r\n  <div class=\"buttons\">\r\n    <button class=\"rpg-button\" (click)=\"adjustHp(false)\">HP abziehen</button>\r\n    <button class=\"rpg-button\" (click)=\"adjustHp(true)\">HP % abziehen</button>\r\n  </div>\r\n</div>\r\n  <div class=\"battle-actions\">\r\n    <button class=\"rpg-button win\" (click)=\"finish(true)\">Sieg</button>\r\n    <button class=\"rpg-button lose\" (click)=\"finish(false)\">Niederlage</button>\r\n  </div>\r\n</div>\r\n\r\n<div *ngIf=\"!battle\" class=\"no-battle\">\r\n  <p>Kein aktiver Kampf.</p>\r\n</div>\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport {  BattleComponent } from './battle.component';\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\n@NgModule({\r\n  declarations: [BattleComponent],\r\n  imports: [\r\n    CommonModule,\r\n    RouterModule.forChild([{ path: '', component: BattleComponent }]),\r\n    FormsModule \r\n  ]\r\n})\r\nexport class BattleModule {}\r\n\r\n"],"names":["BattleService","SoundService","PlayerService","Router","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵelement","ɵɵadvance","ɵɵtextInterpolate","adv_r2","name","description","ɵɵtemplate","BattleComponent_div_0_div_6_li_4_Template","ɵɵproperty","ctx_r2","battle","advantagesUnlocked","ɵɵtwoWayListener","BattleComponent_div_0_div_7_Template_input_ngModelChange_4_listener","$event","ɵɵrestoreView","_r4","ɵɵnextContext","ɵɵtwoWayBindingSet","hpInput","ɵɵresetView","ɵɵlistener","BattleComponent_div_0_div_7_Template_button_click_6_listener","adjustHp","BattleComponent_div_0_div_7_Template_button_click_8_listener","ɵɵtextInterpolate1","playerHp","ɵɵtwoWayProperty","BattleComponent_div_0_div_6_Template","BattleComponent_div_0_div_7_Template","BattleComponent_div_0_Template_button_click_9_listener","_r1","finish","BattleComponent_div_0_Template_button_click_11_listener","bossId","ɵɵpipeBind2","startedAt","length","BattleComponent","battleService","soundService","playerService","router","constructor","ngOnInit","getCurrentBattle","subscribe","b","playBossMusic","loadPlayerHp","getPlayer","player","hp","isPercent","amount","Math","floor","newHp","updatePlayer","won","finishBattle","then","navigate","ɵɵdirectiveInject","i1","i2","i3","i4","selectors","decls","vars","consts","template","BattleComponent_Template","rf","ctx","BattleComponent_div_0_Template","BattleComponent_div_1_Template","CommonModule","RouterModule","FormsModule","BattleModule","forChild","path","component","declarations","imports"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}